# 杂记随笔

今天想了很久,之前的那种主题解析结构很有问题,很容易被用户用各种方式进行注入,特别的不安全,对此,我构思了一种新的解析方法

将主题每行读取出来,判断每行是否有主题语法语句,如有的话就进行编译,(if的话往下寻找endif 和 else,假如先找到endif则停止查找,先找到else就执行else的语法)

对foreach语法,我一直很纠结应如何实现, 是把可编辑度放到最低,只允许规定的几个变量进行foreach?

foreach语法最终可能是这样的

```html
{foreach:easycraft.servers}
<-- 下面只能用 server 来作为each的参数 -->
<h1>Server: {var.server.name}</h1>
{endforeach}
```

想来想去,突然发现变量定义语句少了,在每个页面可以定义变量,但是只能在本页面访问,但是这个可能要等到解析方法改进后再实现了. 万一有人要用if判断来设置变量值,或者用设定的变量值来if判断. 这两个的优先级就容易搞混.

嗯. 我抽个时间吧解析算法大重构一下吧!